{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport React, { useCallback } from 'react';\nimport { useRouter } from 'next/router';\nimport useInfinite from \"@src/hooks/useInfinite\";\nimport { BottomBar, Banner, Header, Button, Loading, BottomLine, Article } from \"@src/components/index\";\nimport './style.scss';\nimport { getArticleList } from \"@src/services/article\";\n\nvar TagList = function TagList(props) {\n  var serverPageNum = props.serverPageNum,\n      serverSucceed = props.serverSucceed,\n      serverHasMore = props.serverHasMore,\n      _props$serverList = props.serverList,\n      serverList = _props$serverList === void 0 ? [] : _props$serverList;\n  var router = useRouter();\n  var key = router.query.key;\n  var getArticleListFn = useCallback( /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref) {\n      var pageSize, pageNum, _yield$getArticleList, data;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              pageSize = _ref.pageSize, pageNum = _ref.pageNum;\n              _context.next = 3;\n              return getArticleList({\n                pageSize: pageSize,\n                pageNum: pageNum,\n                tag: key\n              });\n\n            case 3:\n              _yield$getArticleList = _context.sent;\n              data = _yield$getArticleList.data;\n              return _context.abrupt(\"return\", data);\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }(), [key]); //封装分页详情\n\n  var _useInfinite = useInfinite(getArticleListFn, {\n    pageSize: 5,\n    immediate: !serverSucceed,\n    defaultPage: serverPageNum,\n    hasMore: serverHasMore,\n    defaultList: serverList,\n    defaultLoading: !serverSucceed\n  }),\n      load = _useInfinite.load,\n      hasMore = _useInfinite.hasMore,\n      loading = _useInfinite.loading,\n      list = _useInfinite.list; // 跳转详情\n\n\n  var goPost = useCallback(function (id) {\n    return function () {\n      return router.push(\"/post/\".concat(id));\n    };\n  }, [router]);\n  return __jsx(\"div\", {\n    className: \"home\"\n  }, __jsx(Header, null), __jsx(Banner, null), __jsx(\"div\", {\n    className: \"homeContent\"\n  }, list.map(function (article) {\n    return __jsx(Article, _extends({\n      key: article.id\n    }, article, {\n      onClick: goPost(article.id)\n    }));\n  }), __jsx(\"div\", {\n    className: \"loadBar\"\n  }, loading ? __jsx(Loading, null, \"\\u52A0\\u8F7D\\u4E2D...\") : hasMore ? __jsx(Button, {\n    onClick: load\n  }, \"\\u52A0\\u8F7D\\u66F4\\u591A\") : __jsx(BottomLine, {\n    lineWidth: 100\n  }))), __jsx(BottomBar, null));\n};\n\nexport var __N_SSP = true;\nexport default TagList;","map":null,"metadata":{},"sourceType":"module"}